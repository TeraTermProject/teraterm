<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<title>TTSSH コマンドライン</title>
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" href="../style.css" type="text/css">
</head>
<body>


<h1>TTSSH command line</h1>

<p>
TTSSHでは以下のコマンドラインオプションが使用できます。
</p>


<h2>オプション</h2>

<dl>
  <dt id="hostname">&lt;username&gt;@&lt;host&gt;[:&lt;#TCP port&gt;]</dt>
  <dd>ホスト名指定ではTera Term本体が対応している形式の他に、ttssh拡張としてユーザ名付きも使えます。</dd>

  <dt id="host-url">&lt;scheme&gt;://[&lt;username&gt;[:&lt;password&gt;]@]&lt;host&gt;[:&lt;TCP port&gt;][/]</dt>
  <dd>URL形式も拡張されます。<br>
      &lt;scheme&gt;には、ssh, ssh1, ssh2, slogin, slogin1, slogin2が使えます。<br>
      ポート番号が指定されなかった場合は22が使われます。(設定ファイルのTCPPortの値は無視されます)</dd>

  <dt id="f">/f=&lt;file&gt;</dt>
  <dd>
    teraterm.iniファイル(file)を読み込む<br>
    ファイル名が絶対パスでないときは、<a href="../setup/folder.html">設定ファイルフォルダ</a>からの相対パスと見なされます。
  </dd>

  <dt id="ssh-f">/ssh-f=&lt;file&gt;</dt>
  <dd>
    teraterm.iniファイル(file)を読み込む<br>
    ファイル名が絶対パスでないときは、<a href="../setup/folder.html">設定ファイルフォルダ</a>からの相対パスと見なされます。
  </dd>

  <dt id="ssh-consume">/ssh-consume=&lt;file&gt;</dt>
  <dd>
    teraterm.iniファイル(file)の読み込み後、当該ファイルを削除する。<br>
    ファイル名が絶対パスでないときは、<a href="../setup/folder.html">設定ファイルフォルダ</a>からの相対パスと見なされます。
  </dd>

  <dt id="t">/t=&lt;value&gt;</dt>
  <dd><ul>
        <li><span class="syntax">value=2</span> SSH を有効にする</li>
        <li><span class="syntax">value=2以外</span> SSH を無効にする</li>
      </ul></dd>

  <dt id="nossh">/nossh</dt>
  <dd>SSH 接続を無効にする</dd>

  <dt id="telnet">/telnet</dt>
  <dd>SSH 接続を無効にする<br>
      さらに、Telnet プロトコルを使用する。<a href="./teraterm.html#t">Tera Term の /T=1</a> と同じ。</dd>

  <dt id="1">/1</dt>
  <dd>SSH1 で接続する</dd>

  <dt id="ssh1">/ssh1</dt>
  <dd>SSH1 で接続する</dd>

  <dt id="2">/2</dt>
  <dd>SSH2 で接続する</dd>

  <dt id="ssh2">/ssh2</dt>
  <dd>SSH2 で接続する</dd>

  <dt id="ssh-autologin">/ssh-autologin</dt>
  <dd>空のパスワードでの自動ログインを試みる</dd>

  <dt id="ssh-autologon">/ssh-autologon</dt>
  <dd>空のパスワードでの自動ログインを試みる</dd>

  <dt id="auth">/auth=&lt;mode&gt;</dt>
  <dd>&lt;mode&gt; で指定された認証方式で自動ログインを試みる
      <ul>
        <li><span class="syntax">password</span> パスワード認証</li>
        <li><span class="syntax">publickey</span> 公開鍵認証</li>
        <li><span class="syntax">challenge</span> SSH1:チャレンジレスポンス(TIS)認証 / SSH2:キーボードインタラクティブ認証</li>
        <li><span class="syntax">keyboard-interactive</span> challenge と同じ</li>
        <li><span class="syntax">pageant</span> Pageant を用いた公開鍵認証</li>
      </ul></dd>

  <dt id="user">/user=&lt;username&gt;</dt>
  <dd>ユーザ名を指定する</dd>

  <dt id="passwd">/passwd=&lt;password&gt;</dt>
  <dd>
    パスワードを指定する<br>
    <a href="#passwd_specify">パスワードを指定するときの注意</a>を参照のこと
  </dd>

  <dt id="keyfile">/keyfile=&lt;file&gt;</dt>
  <dd>
    秘密鍵を指定する<br>
    ファイル名が絶対パスでないときは、<a href="../setup/folder.html">設定ファイルフォルダ</a>からの相対パスと見なされます。
  </dd>

  <dt id="ask4passwd">/ask4passwd</dt>
  <dd>
    自動ログインをせず、パスワードを聞く<br>
    /auth=&lt;mode&gt; は、認証方式のみを意味するようになる
  </dd>

  <dt id="ssh-l">/ssh-L[&lt;listen_addr&gt;:]&lt;port1&gt;:&lt;host&gt;:&lt;port2&gt;[,[&lt;listen_addr&gt;:]&lt;port1&gt;:&lt;host&gt;:&lt;port2&gt;[,...]]</dt>
  <dd>ローカルのリッスンアドレス(&lt;listen_addr&gt;)ポート(&lt;port1&gt;)からリモート側ホスト(&lt;host&gt;)のポート(&lt;port2&gt;)へポートフォワーディングする<br>
      &lt;listen_addr&gt;を省略すると、localhostでリッスンする</dd>

  <dt id="ssh-r">/ssh-R[&lt;listen_addr&gt;:]&lt;port1&gt;:&lt;host&gt;:&lt;port2&gt;[,[&lt;listen_addr&gt;:]&lt;port1&gt;:&lt;host&gt;:&lt;port2&gt;[,...]]</dt>
  <dd>リモートのリッスンアドレス(&lt;listen_addr&gt;)ポート(&lt;port1&gt;)からローカル側ホスト(&lt;host&gt;)のポート(&lt;port2&gt;)へポートフォワーディングする<br>
      &lt;listen_addr&gt;を省略すると、localhostでリッスンする<br>
      SSH1プロトコルでは&lt;listen_addr&gt;は利用されない</dd>

  <dt id="ssh-d">/ssh-D[&lt;listen_addr&gt;:]&lt;port&gt;[,[&lt;listen_addr&gt;:]&lt;port&gt;[,...]]</dt>
  <dd>ローカルのリッスンアドレス(&lt;listen_addr&gt;)ポート(&lt;port&gt;)への接続をダイナミック転送する<br>
      SOCKS Proxy として動作する<br>
      &lt;listen_addr&gt;を省略すると、localhostでリッスンする</dd>

  <dt id="ssh-x">/ssh-X[[&lt;hostname&gt;]:&lt;displaynumber&gt;[.&lt;screennumber&gt;]]</dt>
  <dd>X11転送を有効にする<br>
    転送先ディスプレイを指定した場合は、その転送先へX11接続を転送する。<br>
    転送先ディスプレイを指定しなかった場合は、以下の優先順位で転送先が決定される。
    <ol>
      <li>設定ファイルの [TTSSH] セクションの X11Display 設定</li>
      <li>環境変数 DISPLAY の値</li>
      <li>localhost:0.0</li>
    </ol>
  </dd>

  <dt id="ssh-agent">/ssh-A</dt>
  <dd>エージェント転送を有効にする</dd>

  <dt id="ssh-noagent">/ssh-a</dt>
  <dd>エージェント転送を無効にする</dd>

  <dt id="auth">/ssh-agentconfirm=&lt;on/off&gt;</dt>
  <dd>
      <ul>
        <li><span class="syntax">on</span> エージェント転送要求を受け入れるか確認する</li>
        <li><span class="syntax">off</span> エージェント転送要求を受け入れるか確認しない</li>
      </ul></dd>

  <dt id="ssh-v">/ssh-v</dt>
  <dd>ログレベルを VERBOSE モードにする</dd>

  <dt id="ssh-C">/ssh-C</dt>
  <dd>圧縮を有効にする(圧縮レベルは6)</dd>

  <dt id="ssh-C=">/ssh-C=&lt;level&gt;</dt>
  <dd>圧縮レベル(0-9)を指定して圧縮を有効にする</dd>

  <dt id="ssh-c">/ssh-c</dt>
  <dd>圧縮を無効にする</dd>

  <dt id="ssh-icon">/ssh-icon=&lt;icon name&gt;</dt>
  <dd>SSH接続時のアイコンを指定する<br>
      icon nameには、設定ファイルの<a href="../setup/teraterm-win.html#WindowIcon">SSHIcon設定</a>と同じものが使用できます。
  </dd>

  <dt id="ssh-subsystem">/ssh-subsystem=&lt;subsystem&gt;</dt>
  <dd>シェルではなく&lt;subsystem&gt;で指定したサブシステムを起動する。</dd>

  <dt id="ssh-N">/ssh-N</dt>
  <dd>接続時にシェルセッションを開始しない。</dd>

  <dt id="nosecuritywarning">/nosecuritywarning</dt>
  <dd>SSHセキュリティ警告(known_hosts)を無視する。原則、<strong>使用禁止</strong>。<br>

    <u>※本オプションは、工場などの閉じた環境で、機器の自動試験を実現するために用意されました。<br>
       通信にセキュリティリスクがある場合は、絶対に当該オプションを使用しないでください。<br>
       いずれにおいても自己責任でお願いします。<br>
    </u>
  </dd>

</dl>

<p>
パラメータの値にスペースやセミコロンを含めるためには、値全体を `"' で囲んでください。(バージョン 4.63(TTSSH 2.51)以降)<br />
値に `"' を含めるためには、連続した `"'("") を指定してください。(バージョン 4.63(TTSSH 2.51)以降)
</p>
<p>
<strong>以前の仕様</strong><br />
パラメータの値にスペースを含めるためには、`@' を指定してください。'@' を含めるためには '@@' を指定してください。(バージョン 4.10-4.62(TTSSH 1.08-2.50))
</p>


<h2 id="example1">例</h2>

<pre>
ttermpro.exe server1:22 /ssh /ssh-L30025:smtpsrv1:25 /ssh-L30110:pop3srv1:110
ttermpro.exe server1:22 /ssh /ssh-D1080
ttermpro.exe server2:22 /ssh /ssh-X
ttermpro.exe server2:22 /ssh /ssh-Xlocalhost:3.0
ttermpro.exe server3:22 /ssh /2 /auth=password /user=guest /passwd=guest
ttermpro.exe server4:22 /ssh /2 /auth=publickey /user=admin /keyfile=pathofkeyfile /ask4passwd
ttermpro.exe ssh://user:password@server5/ /auth=password
ttermpro.exe server6:22 /ssh /2 /auth=publickey /user=guest /keyfile="C:\Users\foo\Documents\My keys\id_ed25519" /passwd="Yu/eA;G2"
ttermpro.exe server7:22 /ssh /2 /auth=password /user=guest /passwd="foo""bar"
</pre>


<h2 id="passwd_specify">パスワードを指定するときの注意</h2>

<p>
ttermpro.exe にコマンドライン引数でパスワードを指定すると、起動しているプロセスのコマンドライン引数を確認することによって、パスワードを見ることができます。<br>
コマンドライン引数を見られる権限がなければ見られませんが、悪用される可能性がないとは言い切れません。<br>
以下に、パスワードが指定されるケースと、回避方法があるかどうかを挙げます。
</p>

<dl>
  <dt>コマンドライン引数を指定して実行する</dt>
  <dd>
    次のようにコマンドプロンプトから、あるいは「ファイル名を指定して実行」から、あるいはショートカットから起動（接続）する<br>
    <pre>ttermpro.exe server3:22 /ssh /2 /auth=password /user=guest /passwd=guest</pre>
    このように起動した場合は、そのプロセスのコマンドライン引数は見えることになります。
  </dd>
  <dt>"File &gt; Duplicate session" (Tera Term 5.6.0 に含まれる TTSSH 3.6.0 より前)</dt>
  <dd>
    Tera Term が内部でコマンドライン引数を生成して ttermpro.exe を起動しています。そのため、そのプロセスのコマンドライン引数は見えることになります。<br>
    TTSSH 3.6.0 以降は、コマンドライン引数でパスワードを渡さなくなりました。
  </dd>
  <dt>New Connection ダイアログの "Host" に指定して接続する</dt>
  <dd>
    New Connection ダイアログの Host には、コマンドライン引数を指定することができます。<br>
    New Connection ダイアログを表示した Tera Term が未接続のときには、新しい ttermpro.exe を起動しないため問題ありません。<br>
    Tera Term がすでに接続されているときは新たな ttermpro.exe を引数付きで起動するため、そのプロセスのコマンドライン引数は見えることになります。<br>
    「接続済みの Tera Term から新たな接続をしない」ことで回避できます。
  </dd>
  <dt>connect マクロコマンドの引数に指定する</dt>
  <dd>
    connect マクロコマンドの引数は、マクロから ttermpro.exe を起動する引数です。<br>
    マクロから Tera Term にリンクしていない状態で次のような connect コマンドを実行すると、新たな ttermpro.exe を引数付きで起動するため、そのプロセスのコマンドライン引数は見えることになります。<br>
    <pre>connect 'server3:22 /ssh /2 /auth=password /user=guest /passwd=guest'</pre>
    次のように、まず Tera Term とリンクしてからあらためて接続すると、引数付きで新たな ttermpro.exe が起動しません。
    <pre>
; '/DS' option suppresses "New Connection" dialog
connect '/DS'
connect 'server3:22 /ssh /2 /auth=password /user=guest /passwd=guest'
    </pre>
  </dd>
  <dt>TeraTerm Menu から起動する (Tera Term 5.6.0 に含まれる TeraTerm Menu 1.21 より前)</dt>
  <dd>
    TeraTerm Menu は入力した内容をコマンドライン引数にして新たな ttermpro.exe を起動するため、そのプロセスのコマンドライン引数は見えることになります。<br>
    上記のようなマクロを記述し、SSH 接続設定の代わりにマクロファイルを使う指定をすることで回避できます。<br>
    TeraTerm Menu 1.21 から、コマンドライン引数でパスワードを渡さなくなりました。
  </dd>
</dl>


<h2 id="example2">例: Pageantとの連携</h2>

<p>
<a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank">Pageant</a>をスタートアップフォルダへ設置させます。
</p>

<pre>
C:\usr\pageant.exe c:\usr\Identity.ppk
</pre>

<p>
Tera TermからPageantを利用して、公開鍵認証による接続をするには以下のようにします。
</p>

<pre>
ttermpro.exe shell.osdn.net:22 /ssh /auth=pageant /user=yutaka
</pre>

</body>
</html>
