<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
  "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<TITLE>Development environment & Libraries</TITLE>
<META http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" href="../style.css" type="text/css">
</HEAD>
<BODY>

<h1 class="center">Development environment & Libraries</h1>

<ol>
  <li><a href="#build-env">Build environment</a></li>
  <li><a href="#build-quick">How to build (Quick Start)</a>
    <ol>
      <li><a href="#build-quick-checkout">Checkout source code</a></li>
      <li><a href="#build-quick-all">Build</a></li>
    </ol>
  </li>
  <li><a href="#build-detail">How to build (Detail)</a>
    <ol>
      <li><a href="#build-checkout">Clone source code</a></li>
      <li><a href="#build-library">Build libraries</a></li>
      <li><a href="#build-teraterm">Build Tera Term</a></li>
      <li><a href="#build-ttssh">Build TTSSH</a></li>
      <li><a href="#build-ttproxy">Build TTProxy</a></li>
      <li><a href="#build-ttxkanjimenu">Build TTXKanjiMenu</a></li>
      <li><a href="#build-ttxsamples">Build TTXSamples</a></li>
      <li><a href="#build-teraterm-menu">Build TeraTerm Menu</a></li>
      <li><a href="#build-cygterm">Build CygTerm</a></li>
      <li><a href="#build-cyglaunch">Build Cyglaunch</a></li>
      <li><a href="#build-htmlhelp">Build HTML help file</a></li>
      <li><a href="#build-installer">Create installer</a></li>
    </ol>
  </li>
</ol>

<hr>

<h2 id="build-env">Build environment</h2>

<ul>
  <li>Install Visual Studio Community 2022
    <ul>
      <li>Desktop development with C++</li>
      <li>C++ v14.30 (17.0) MFC for v143 build tools (x86 & x64)<br />
        HTML Help Compiler (hhc.exe) is installed.
      </li>
    </ul>
  </li>
  <li>Install Cygwin<br />
    You can run buildtools\install_cygwin.bat to install Cygwin environment only for CygTerm+ compile.<br />
    Please read <a href="../usage/cygwin.html#build">this page</a> to use existing Cygwin environment.
  </li>
  <li>Install Perl</li>
  <li>Install Git for Windows</li>
  <li>Install CMake</li>
  <li>Install Inno Setup</li>
</ul>

<p>
You can install new tools for Tera Term, but you can also choice using existing tools for build Tera Term.<br />
If installer\release.bat cannot find a installed tool, copy installer\toolinfo_sample.bat as installer\toolinfo.bat, and edit it.<br />
And if necessary, copy buildtools\svnrev\toolinfo_sample.txt as buildtools\svnrev\toolinfo.txt, and edit it.
</p>

<p>
If you run build.bat not via installer\release.bat (e.g. run makearchive.bat directly, makearchive.bat is run via Inno Setup Studio), set environment variable.
</p>
<pre>
Example:
VS170COMNTOOLS=C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\Tools
VS160COMNTOOLS=c:\Program Files (x86)\Microsoft Visual Studio\2019\Community\Common7\Tools
</pre>

<h2 id="build-quick">How to build (Quick Start)</h2>

<h3 id="build-quick-checkout">Checkout source code</h3>

<p>
Clone source code from GitHub (https://github.com/TeraTermProject/teraterm).
</p>

<h3 id="build-quick-all">Build</h3>

<p>
Run installer\release.bat, and select 3.
</p>

<h2 id="build-detail">How to build (Detail)</h2>

<h3 id="build-checkout">Clone source code</h3>

<p>
Clone source code from GitHub (https://github.com/TeraTermProject/teraterm).
</p>

<h3 id="build-library">Build libraries</h3>

<p>
Launch "x86 Native Tools Command Prompt for VS 2022" batch file from start menu, or set appropriate directory to PATH.<br />
You can run libs\buildall.bat to build all libraries instead of run each batch files. *
</p>

<ul>
  <li>Oniguruma
    <ol>
      <li>Extract oniguruma source into libs/oniguruma directory.</li>
      <li>Run libs\buildoniguruma6.bat. *</li>
    </ol>
  </li>
  <li>SFMT
    <ol>
      <li>Extract SFMT source into libs/SFMT directory.</li>
      <li>Run libs\buildSFMT.bat. *</li>
      <li>Modify version information in libs/SFMT/SFMT_version_for_teraterm.h if necessary.</li>
    </ol>
  </li>
  <li>LibreSSL
    <ol>
      <li>Extract LibreSSL source into libs/libressl directory.<br />
      <li>Run buildlibressl.bat. *</li>
    </ol>
  </li>
  <li>Zlib
    <ol>
      <li>Extract zlib source into libs/zlib directory.</li>
      <li>Run buildzlib.bat. *</li>
    </ol>
  </li>
  <!--
  <li>PuTTY
    <ol>
      <li>Extract PuTTY source into libs/putty directory.</li>
    </ol>
  </li>
  -->
  <li>The reference C implementation of Argon2
    <ol>
      <li>Extract argon2 source into libs/argon2 directory.</li>
    </ol>
  </li>
  <li>cJSON
    <ol>
      <li>Extract cJSON source into libs/cJSON directory.</li>
    </ol>
  </li>
</ul>

<h3 id="build-teraterm">Build Tera Term</h3>

<ol>
  <li>Open teraterm\ttermpro.sln with Visual Studio.<br />
      The linefeed code of .sln file must be "CR+LF".</li>
  <li>Build Tera Term solution.</li>
  <li>Tera Term execution program files will be generated in teraterm\Debug / teraterm\Release directory if the building is successful.</li>
</ol>

<h3 id="build-ttssh">Build TTSSH</h3>

common_static.lib must be built beforehand by teraterm\ttermpro.sln.

<ol>
  <li>Open ttssh2\ttssh.sln with Visual Studio.</li>
  <li>Build TTSSH solution.</li>
  <li>TTSSH DLL module will be generated in ttssh2\ttxssh\Debug / ttssh2\ttxssh\Release directory if the building is successful.</li>
</ol>

<h3 id="build-ttproxy">Build TTProxy</h3>

common_static.lib must be built beforehand by teraterm\ttermpro.sln.

<ol>
  <li>Open TTProxy\TTProxy.sln with Visual Studio.</li>
  <li>Build TTProxy solution.</li>
  <li>TTProxy DLL module will be generated in TTProxy\Debug / TTProxy\Release directory if the building is successful.</li>
</ol>

<h3 id="build-ttxkanjimenu">Build TTXKanjiMenu</h3>

common_static.lib must be built beforehand by teraterm\ttermpro.sln.

<ol>
  <li>Open TTXKanjiMenu\ttxkanjimenu.sln with Visual Studio.</li>
  <li>Build TTXKanjiMenu solution.</li>
  <li>Ttxkanjimenu DLL module will be generated in TTXKanjiMenu\Debug / TTXKanjiMenu\Release directory if the building is successful.</li>
</ol>

<h3 id="build-ttxsamples">Build TTXSamples</h3>

<!--
<p>
リポジトリのTTXSamplesに Tera Term Extension (TTX)のサンプルがあります。TTXを作る際の参考にしてください。
</p>
-->

common_static.lib must be built beforehand by teraterm\ttermpro.sln.

<ol>
  <li>Open TTXSamples\TTXSamples.sln with Visual Studio.</li>
  <li>Build TTXSamples solution.</li>
  <li>DLL modules will be generated in TTXSamples\Debug / TTXSamples\Release directory if the building is successful.</li>
</ol>

<!--
<p>
各TTXの詳細については、プロジェクト内のReadMe-ja.txtを参照してください。
</p>
-->

<h3 id="build-teraterm-menu">Build TeraTerm Menu</h3>

common_static.lib must be built beforehand by teraterm\ttermpro.sln.

<ol>
  <li>Open ttpmenu\ttpmenu.sln with Visual Studio.</li>
  <li>Build ttpmenu solution.</li>
  <li>ttpmenu.exe will be generated in ttpmenu\Debug / ttpmenu\Release directory if the building is successful.</li>
</ol>

<h3 id="build-cygterm">Build CygTerm+</h3>

<ol>
  <li>Launch Cygwin shell and go to cygterm directory.
<pre>
# cd cygterm
</pre>
  </li>
  <li>Compile CygTerm+.
<pre>
# make
</pre>
  </li>
  <li>cygterm.exe will be generated.</li>
</ol>

<h3 id="build-cyglaunch">Build Cyglaunch</h3>

common_static.lib must be built beforehand by teraterm\ttermpro.sln.

<ol>
  <li>Open cygwin\cygwin.sln with Visual Studio.</li>
  <li>Build cygwin solution.</li>
  <li>cyglaunch.exe will be generated in cygwin\Debug / cygwin\Release directory if the building is successful.</li>
</ol>

<h3 id="build-htmlhelp">Build HTML help file</h3>

<ol>
  <li>Run doc\makechm.bat.</li>
</ol>

<h3 id="build-installer">Create installer</h3>

<dl>
  <dt>When use AppVeyor</dt>
  <dd>
    Run "NEW BUILD" in AppVeyor.<br>
    installer\release.bat is called.
  </dd>
  <dt>When use installer\release.bat</dt>
  <dd>
    Run installer\release.bat to create installer and zip.<br>
    File name is constructed from buildtool\svnrev\sourcetree_info.bat. It is written by buildtools\svnrev\svnrev.bat from teraterm\common\tt-version.h.
    <ul>
      <li>
        Run installer\release.bat.<br>
        Create installer in installer\iscc.bat called installer\release.bat.
      </li>
      <li>A installer and zipped portable version is generated in installer\Output folder.</li>
    </ul>
  </dd>
  <dt>When use Inno Script Studio</dt>
  <dd>
    It is easier to use installer\release.bat when create an RC,release.<br>
    Debugging installer is easy to use Inno Script Studio.
    File name of installer is constructed from definition of installer\teraterm.iss. File name of portable version is constructed from buildtool\svnrev\sourcetree_info.bat.
    <ul>
      <li>Open installer\teraterm.iss with Inno Script Studio, and create installer by "Project"-"Compile."</li>
      <li>A installer and portable version is generated in installer\Output folder.</li>
      <li>Compress portable version with zip.</li>
    </ul>
  </dd>
</dl>

</body>
</html>
