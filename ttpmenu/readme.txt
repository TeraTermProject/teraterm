--------------------------------------------------------------------------------
                               Tera Term支援ツール
                           TeraTerm Menu Version 1.20

                          (C) 2004- TeraTerm Project
                        https://teratermproject.github.io/

                        Copyright (C) 1997-2003  S.Hayakawa
                                All Rights Reserved.
--------------------------------------------------------------------------------
目次
  1. 概要
  2. 著作権等
  3. 動作環境
  4. インストール
  5. 使用方法
  6. 設定
  7. よくある質問
  8. 備考
  9. 更新履歴
  10. 謝辞
--------------------------------------------------------------------------------
1. 概要

TeraTerm Menuは Tera Term Proの使用を支援するためのソフトです。
タスクトレイに常駐し、登録されたホストへの自動ログインを実現します。

また簡単なアプリケーションランチャーとしても御使用いただけます。

--------------------------------------------------------------------------------
2. 著作権等

2004年に作者の早川氏に許可をいただきTera Termのソースツリーにマージされました。

このTeraTerm MenuはTeraTerm Projectによって保守されています。

問い合わせはTeraTerm Projectにお願いします。
https://teratermproject.github.io/

以下はオリジナルの著作権表示です。

--
このプログラムはフリーソフトウェアです。
著作権は、作者（早川信平）が保持します。
このプログラムの使用による、いかなる損害に対しても、作者は責任を負いません。

作者へ要望や質問、バグの報告などは以下までお願い致します。

shinpei@bb.wakwak.com
--

--------------------------------------------------------------------------------
3. 動作環境

Tera Term が動作する環境で動作します。

--------------------------------------------------------------------------------
4. インストール

Tera Termに同梱されています。
Tera Termのインストーラー/アーカイブ(zip)に含まれています。

--------------------------------------------------------------------------------
5. 使用方法

(1) ttpmenu.exeをダブルクリックするなどして実行して下さい。
    するとタスクトレイに TeraTermアイコンが登録されます。

(2) タスクトレイに登録された Tera Termアイコンをマウスで、右クリックして下さい。
    するとポップアップメニューは開きますので、その中の「リスト編集」を選択して
    下さい。すると「リスト編集」ダイアログが開きます。

(3) ここで自動ログイン等の設定を行います。各項目の設定後は左向き矢印のボタンを
    押して登録して下さい。なお右向き矢印のボタンを押すと登録が削除されます。
    各項目の設定内容は以下の通りです。

    (a) 登録名

        設定の名前を入力します。なお名前に "\" は使えません。

    (b) 自動ログイン

        sshを使用しない場合:

        ホストへの自動ログインをするマクロファイルを自動生成し、そのファイルを
        TeraTermの /Mオプションにより実行します。

        ・ホスト名  ：ログインしたいホスト名を入力して下さい。
        ・ユーザ名  ：ログインするユーザ名を入力して下さい。なお「ユーザ名」と
                      表示されているボタンを OFF状態にすると、自動ログイン時に
                      ユーザ名の自動入力は行われません。
        ・パスワード：ログインするユーザ名のパスワードを入力して下さい。なお
                     「パスワード」と表示されているボタンを OFF状態にすると、
                      自動ログイン時にユーザ名の自動入力は行われません。

        sshを使用する場合:

        TeraTerm のttxsshプログインのオプションを自動的に設定して実行します。

     (c) マクロファイルを指定して実行

         指定されたマクロファイルを TeraTermの /Mオプションにより実行します。

        ・エディットボックスにマクロファイルを指定して下さい。なお詳細項目は
          自動ログインと同様です。（プロンプトのみ無効）

     (d) 起動のみ

         TeraTermを起動します。また詳細で任意のアプリケーションを設定することに
         より、簡単なアプリケーションランチャーとしても御使用いただけます。
         なお、起動するアプリケーションの設定は「(e) 詳細」にて説明します。

     (e) 詳細設定

         詳細な設定をしたい場合に御使用下さい。
            ・起動アプリ  ：御使用したい TeraTermを指定します。
            ・オプション  ：起動時のオプションや引数を指定します。
            ・設定ファイル：御使用したい設定ファイルを指定します。
            ・ログファイル：Tera Term のログを保存するファイルを指定します。
            ・プロンプト  ：ログインプロンプト、パスワードプロンプトを指定
                            します。
         詳細設定を行った際、必ず登録ボタン（三角のボタン）を押して保存して
         下さい。

     (f) 起動時に実行

         TeraTerm Menu 起動時に当該の設定を実行します。

(4) 設定が終わった後、ポップアップメニュー内の「実行」にマウスカーソルを合わせる
    と設定一覧のポップアップメニューが表示されます。ここでお好きな設定を選択して
    いただくことにより、実行することができます。

(5) ポップアップメニュー内の「表示」にマウスカーソルを合わせると、設定一覧ポップ
    アップメニューの表示設定等ができます。この設定は TeraTerm Menuを終了時に
    自動的に現在の状態を保存いたします。
    なお表示設定の項目は以下の通りです。

    ・大きいアイコンで表示
        チェックすると設定一覧のポップアップメニューにあるアイコンが大きいアイコ
        ンで表示されます。（デフォルトは未チェック）
    ・フォントを指定
        設定一覧のポップアップメニューのフォントを指定します。
    ・右クリックでリスト表示
        チェックするとタスクトレイのアイコンを左クリックしたとき、設定一覧のポッ
        プアップメニューが表示されます。なお未チェックの場合は、右クリックと同様
        の動作をします。
    ・リスト表示ホットキー(Ctl+Alt+M)
        ホットキーによるリスト表示を有効にします。

--------------------------------------------------------------------------------
6. 設定

設定はデフォルトでレジストリが使用されます。
TeraTerm Menuが起動するときにiniファイルが存在する場合
iniファイルが使用されます。

使用するレジストリ
  HKEY_CURRENT_USER\Software\ShinpeiTools\TTermMenu

使用するiniファイル
  %APPDATA%\teraterm5\ttpmenu.ini (通常)
  ttpmenu.exe と同じフォルダの ttpmenu.ini (ポータブル版)

iniファイルはUnicode iniファイル(UTF-16 with LE BOM)の使用をおすすめします。
次を参照ください。
  https://teratermproject.github.io/manual/5/ja/reference/dev/win32api.html#ini_file

バージョンダイアログにどの設定を使用しているか表示されます。

レジストリの内容をiniファイルに変換するときは次の変換スクリプトをご利用ください
  https://github.com/TeraTermProject/teraterm/tree/main/installer/ttpmenu

ポータブル版については次を参照してください
  https://teratermproject.github.io/manual/5/ja/setup/folder.html

レジストリ、iniファイルにはパスワードが保存されています。
取り扱いには注意してください。

LockBoxを有効にすると、パスワードが暗号化されて保存されます。

管理者権限を持つユーザはProcess Explorerなどのツールを用いてTeraTerm Menuから
起動されたTera Termのユーザ名、パスワードなどの引数を表示させることが可能です。
情報漏洩のリスクがある環境では、TeraTerm Menuの利用をお控えください。

--------------------------------------------------------------------------------
7. よくある質問

    Q.  TeraTerm Menuの設定はどこに保存されているか？
    A.  下記のレジストリにすべて保存されています。
          HKEY_CURRENT_USER\Software\ShinpeiTools\TTermMenu
        他マシンに情報を持っていきたい場合は、上記のキーをレジストリエディタ等
        でファイルに保存して、他マシンでリストアすれば情報は移行されます。
        ※ レジストリの編集は自己責任の元に行って下さい。
           ファイルのパス等もすべて旧マシンの情報そのままですのでご注意下さい。

    Q.  リストを任意の順番に並べたい。
    A.  TeraTerm Menu自身では今のところ並べ替えに対応していません。
        但し、NT/2000/XPの場合、登録名の前に数字等を入れることによって、ある
        程度順位付けする事ができます。
          例. 登録名->「01.hoge」

    Q.  自動ログイン時には、どのようなマクロを生成・実行しているのか？
    A.  多少修正はしてありますが、基本的には Tera Term Proに同梱してある
          login.ttl
        というサンプルのマクロファイルの内容とほぼ同じものを実行しています。
        ※ 結構簡単なマクロです。

    Q.  自動ログイン後に、任意のコマンドを実行したい。
    A.  現在のところ、できません。
        どうしても実行したい場合は、A4にある login.ttlを編集したマクロファイル
        を「マクロファイルを指定して実行」モードで実行する事で対処できます。

--------------------------------------------------------------------------------
8. 備考

    マクロの実行途中で TeraTermを終了させた場合マクロファイル（ttm****.tmp）が
    テンポラリフォルダに残る場合がありますのでご注意下さい。

--------------------------------------------------------------------------------
9. 更新履歴

TeraTerm Menu 1.20 (2024.7.28)

・ログインパスワードを暗号化/復号するLockBoxを追加した。
・Detailsダイアログで実行ファイル名に"ttermpro.exe"か含まれている場合に"use SSH"のチェックボックスがONになる処理をなくした。
・情報漏洩のリスクを加筆した。
・List Configurationダイアログのタイトルの誤字を修正した。(Cofiguration -> Configuration)
・本ドキュメントがTera Termのインストーラー/アーカイブ(zip)に反映されるよう修正した。

TeraTerm Menu 1.19 (2024.2.29)

・接続先が登録されていないとき、"(none)"が正しく表示されないので修正した。
・ttermpro.exe のパスを Win.ini から読み込まないよう修正した。

TeraTerm Menu 1.18 (2023.12.02)

・使用しているWin32 APIを Unicode版に変更、文字列をUnicodeに変更した。
・TeraTerm Menuから起動するプログラムの引数長の上限をなくした。
・従来の設定を引き継げるようiniファイルをコピーするようにした。
  - ttpmenu.exeと同じパスの ttpmenu.ini が存在して
    %APPDATA%\teraterm5\ttpmenu.ini が存在しない場合
・ポータブル版動作(exeフォルダにportable.iniが存在する)に対応した。
・%APPDATA%\teraterm5\ttpmenu.ini が0byteの時、UTF-16 LE BOM を書き込むようにした。
・ttpmenu.iniのファイル名長の上限をなくした。
・バージョン表示に設定がレジストリ/iniのどちらかを表示するようにした。

TeraTerm Menu 1.17 (2023.10.15)

・260 文字以上の引数を ttermpro.exe に渡せるようにした。

TeraTerm Menu 1.16 (2021.6.5)

・リストへ登録するボタンのツールチップの文言をRegister, Unregisterに変更した。
・バージョン情報に余計な￥が表示されていた問題を修正した。

TeraTerm Menu 1.15 (2017.11.30)

・ttpmenu.ini を使っている場合にすべてのホスト設定名を格納するバッファサイズを拡張した(2.6KB -> 10KB)。

TeraTerm Menu 1.14 (2016.11.30)

・TeraTermアイコン(teraterm.ico)を新しくした。

TeraTerm Menu 1.13 (2015.05.31)

・SSH セッションの開始時に引き渡すファイル名・パスワード値に ; が含まれるときにクォートされない問題を修正した。

TeraTerm Menu 1.12 (2014.08.31)
・タスクトレイに表示されないことがある問題を修正した。

TeraTerm Menu 1.11 (2011.12.04)
・パスワードに制御文字(^A-^_)を入力できるようにした。

TeraTerm Menu 1.10 (2011.6.26)
・アイコンリソースの開放漏れを修正した。

TeraTerm Menu 1.09 (2009.7.5)
・TTSSH のコマンドライン仕様変更に対応した。

TeraTerm Menu 1.08 (2008.6.25)
・Pageant に対応した。
・TeraTermアイコン(teraterm.ico)を新しくした。坂本龍彦氏に感謝します。

TeraTerm Menu 1.07 (2007.12.4)
・TeraTerm Menuの設定を .ini ファイルへ保存できるようにした。.iniファイルを使う場合は、"ttpmenu.exe"があるディレクトリに"ttpmenu.ini"（0バイトで可）を設置する。ただし、レジストリから.iniファイルへの移行は自動で行なわないので、手動で再登録すること。パッチ作成に感謝します＞まつも氏。
・keyboard-interactive認証(/challenge)へ対応させた。
・メッセージファイルがないときにファイルダイアログの拡張子フィルタが正しく動作しない問題を修正した。
・アプリケーションを相対パスで指定しているとき、起動しないことがある問題を修正した。

TeraTerm Menu 1.06 (2007.9.30)
・ユーザインターフェイスのメッセージを読み込めるようにした。

TeraTerm Menu 1.05 (2007.3.10)
・Windows Vista で、ポップアップメニューが正しい位置に表示されない問題を修正した。

TeraTerm Menu 1.04 (2006.2.24)
・VS2005でビルドエラーとなる問題を修正した

TeraTerm Menu 1.03 (2005.1.30)
・TeraTerm Menuをマルチモニタ環境で使用すると、ポップアップメニューが正しいモニタに表示されないバグを修正した。

TeraTerm Menu 1.02 (2005.1.30)
・オプションに漢字コード(/KT=UTF8 /KR=UTF8)を追加した。
・SSH自動ログインにおいて、ユーザパラメータを指定できるようにした。
・SSH自動ログインにおいて、マクロの指定を削除した。
・SSH自動ログインにおいて、秘密鍵ファイルの指定をできるようにした。

TeraTerm Menu 1.01 (2004.12.14)
・ttermpro.exeの初期フォルダパスをカレントディレクトリに変更。

TeraTerm Menu 0.94 Release 2 (2003.1.7)
・エクスプローラが落ちて再起動したときなどに、タスクトレイにあるアイコンが
  失われてしまう問題を修正
・その他小修正

TeraTerm Menu 0.94 Release 1 (2001.11.1)
・「起動時に実行」オプションを追加
・ホットキーによるリスト表示を追加
・Tera Term のログ保存オプションを追加
・リスト編集ダイアログのデザインなどを変更
・自動ログイン用のテンポラリマクロファイルの名前を動的に生成するよう修正

TeraTerm Menu 0.93 Release 4 (1999.4.19)
・新規インストール直後にメニューの色がおかしく表示される不具合を修正
・リスト編集ダイアログのデザインなどを変更
・その他小修正

TeraTerm Menu 0.93 Release 3 (1998.12.14)
・フォント設定ダイアログでキャンセルしたにも関わらずフォントが変更されてしまう
  という不具合を修正

TeraTerm Menu 0.93 Release 2 (1998.12.14)
・詳細設定をせずに登録すると登録が失敗するという不具合を修正

TeraTerm Menu 0.93 (1998.12.10)
・タスクトレイのアイコンを左クリックしたときに設定一覧のポップアップメニューが
  表示されるように変更。（設定により変更可能）
・ttsshの使用をチェックボックスで指定できるように変更
・設定一覧に登録がない場合に「(なし)」という表示をするように変更
・Windowsの終了時に表示設定が保存されないという不具合を修正

TeraTerm Menu 0.93β2 (1998.12.8)
・設定一覧のポップアップメニューのフォントを指定できるように変更
・設定ダイアログで設定を追加したとき、追加した設定でない設定にフォーカスが
  いってしまうことがあるという不具合を修正

TeraTerm Menu 0.93β (1998.12.4)
・設定一覧のポップアップメニューを独立したポップアップメニューに変更
・設定一覧のポップアップメニューおよび設定ダイアログ内の設定リストにアイコンを
  表示
・ファイルの参照ダイアログでショートカットも指定できるように修正
・設定ダイアログの一部にツールチップを追加
・設定ダイアログで設定を追加したとき、追加した設定にフォーカスが行くように修正
・アイコンをTeraTermの最新アイコンに変更

 TeraTerm Menu 0.90β (1998.11.21)
・マクロファイルを指定しての実行を追加
・詳細設定により、オプション指定や自動ログオン時のプロンプトの設定を追加
・詳細設定で起動アプリケーションを指定できるように変更
・「ttpmenuについて」ダイアログを追加
・TeraTermの直接起動を削除
・自動ログインマクロの実行をttpmacro.exeで実行していたのを、ttermpro.exeで
  実行するよう変更
・Windows 95において、設定ダイアログを２回開くとTeraTerm Menuが落ちてしまう
  ことがあるという不具合を修正

--------------------------------------------------------------------------------
10. 謝辞

    このソフトを作るきっかけ及びアドバイスをいただいた白水啓章さん、Tera Term
    という素晴らしいソフトをこの世に送り出してくれ、またこのソフトの改良の際
    アドバイス等をいただいた寺西高さんに感謝致します。

    また実際にこのソフトを使用していただき、色々なアドバイスや不具合報告をして
    いただいた皆様、ありがとうございました。

--------------------------------------------------------------------------------
